<main class="grid-container">
  {{!-- Website Name --}}
  <header class="grid-x grid-padding-x align-center">
    <h1>Gifted</h1>
  </header>
  {{!-- Page Title --}}
  <div class="grid-x grid-padding-x align-center">
    <h2 class="text-center">Gifts You Received</h2>
  </div>
  {{!-- Add Button --}}
  <div class="grid-x grid-padding-x align-center">
    <a href="/add/received" class="button">Add a New Gift</a>
  </div>
  {{!-- Table --}}
  <section class="grid-x grid-padding-x align-center">
    <table class="hover">
      <thead>
        <tr>
          <th width="150">Gift You Received</th>
          <th width="150">Date Received</th>
          <th width="150">Occasion</th>
          <th width="150">Sender's Name</th>
          <th width="150">Sender's Address</th>
          <th width="150">Thank You</th>
          <th width="150">Edit/Delete</th>
        </tr>
      </thead>
      <tbody>
        {{#each gifts}}
        <tr>
          <td><span>{{giftReceived}}</span><input type="text" value="{{giftReceived}}" class="displayNone"></td>
          <td><span>{{dateReceived}}</span><input type="text" value="{{dateReceived}}" class="displayNone"></td>
          <td><span>{{occasion}}</span><input type="text" value="{{occasion}}" class="displayNone"></td>
          <td><span>{{senderName}}</span><input type="text" value="{{senderName}}" class="displayNone"></td>
          <td><span>{{senderAddress}}</span><input type="text" value="{{senderAddress}}" class="displayNone"></td>
          <td>
            <ul class="dropdown menu" data-dropdown-menu>
              <li>
                <a>{{#if thankYou}}Sent{{else}}Not Sent{{/if}}</a>
                <ul class="menu">
                  <li><a data-id="{{id}}" class="thankYouBtn">{{#unless thankYou}}Sent{{else}}Not Sent{{/unless}}</a>
                  </li>
                </ul>
              </li>
            </ul>
          </td>
          <td><button data-id="{{id}}" type="button" class="editbtn small button success">edit</button>
            <button data-id="{{id}}" type="button" class="deletebtn small button alert">delete</button></td>
        </tr>
        {{/each}}
      </tbody>
    </table>
  </section>
</main>

<script>
  $(document).ready(function () {

    // Sets up Foundation JavaScript
    $(document).foundation();

    $(".thankYouBtn").on("click", function (event) {
      console.log("Button worked");
    });

    // Delete Button Event Listener
    $(".editbtn").on("click", function (event) {

      const id = $(this).data("id");
      const array = $(this).parent().siblings();
      array[0].children[0].setAttribute("class", "displayNone");
      array[0].children[1].removeAttribute("class");

    });

    // Delete Button Event Listener
    $(".deletebtn").on("click", function (event) {

      const id = $(this).data("id");

      // AJAX Call - Delete Table Row
      $.ajax("/api/received/" + id, {
        type: "DELETE",
      }).then(() => {
        location.reload();
      });
    });

  });
</script>